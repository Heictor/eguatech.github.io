<!doctype html><meta charset=utf-8><meta name=viewport content="width=device-width"><title>Testing - Rocket Programming Guide</title><meta name=description content="Rocket is a web framework for the Rust
      programming language that makes it simple to write fast web applications
      without sacrificing flexibility or type safety."><meta name=author content="Sergio Benitez"><link href="https://fonts.googleapis.com/css?family=Proza+Libre:400,500" rel=stylesheet><link rel=stylesheet href=../../v0-4/css/style.css media=all><link rel=icon type=image/png href=../../v0-4/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=../../v0-4/images/favicon-16x16.png sizes=16x16><style media=screen>.clouds.back{background:transparent url(../../v0-4/images/clouds-back.png) repeat}.clouds.front{background:transparent url(../../v0-4/images/clouds-front.png) repeat-x}#logo{background-image:url(../../v0-4/images/logo.svg)}@media(max-width:870px){#logo{background-image:url(../../v0-4/images/logo-small.svg)}}input#search-input{background-image:url(../../v0-4/images/search-icon.svg)}.cancel-search{background:url(../../v0-4/images/cancel-icon.svg) no-repeat center}.admonition.note .title{background-image:url(../../v0-4/images/pencil-icon.svg)}.admonition.tip .title{background-image:url(../../v0-4/images/star-icon.svg)}.admonition.warning .title{background-image:url(../../v0-4/images/warning-icon.svg)}</style><header><div class="back clouds"></div><div class="front clouds"></div><div class=container><a id=logo href=../../index.html ><span>Rocket Homepage</span></a><nav class=version-select><span onclick=toggleOptions()>v0.4 <i></i></span><options><a href=../../v0-3.html >v0.3</a></options></nav><input type=checkbox id=toggle> <label for=toggle class=hamburger><span></span> <span></span> <span></span></label><nav class=main><a href=../../v0-4/overview.html>overview</a> <a href=../../v0-4/guide.html>guide</a> <a href=../../api_subdomain/v0-4/rocket.html>api</a> <a href=../../v0-4/news.html>news</a> <a href=https://github.com/SergioBenitez/Rocket/tree/v0.4>code</a></nav><div class=centered><h1><a href=../../v0-4/guide.html>Guide</a></h1><h4>The ins and outs of Rocket, in detail.</h4></div></div></header><section class="grid tight blocky-code"><div id=sidebar><nav><input id=search-input placeholder="Search guide..."><div class=toc><ul class=small><li><a href=../../index.html>Introduction</a></ul><ul class=small><li><a href=../../index.html>Quickstart</a></ul><ul class=small><li><a href=../../index.html>Getting Started</a></ul><ul class=small><li><a href=../../index.html>Overview</a></ul><ul class=small><li><a href=../../v0-4/guide/requests.html>Requests</a></ul><ul class=small><li><a href=../../v0-4/guide/responses.html>Responses</a></ul><ul class=small><li><a href=../../index.html>State</a></ul><ul class=small><li><a href=../../index.html>Fairings</a></ul><ul><li><a href=#testing>Testing</a><ul><li><a href=#local-dispatching>Local Dispatching</a><li><a href=#validating-responses>Validating Responses</a><li><a href=#testing-hello-world>Testing "Hello, world!"</a><ul><li><a href=#setting-up>Setting Up</a><li><a href=#testing_1>Testing</a></ul><li><a href=#codegen-debug>Codegen Debug</a></ul></ul><ul class=small><li><a href=../../v0-4/guide/configuration.html>Configuration</a></ul><ul class=small><li><a href=../../index.html>Pastebin</a></ul><ul class=small><li><a href=../../index.html>Conclusion</a></ul></div></nav></div><article><h2 id=testing>Testing<a class=headerlink href=#testing title="perma link">#</a></h2><p>Every application should be well tested and understandable. Rocket provides the tools to perform unit and integration tests. It also provides a means to inspect code generated by Rocket.<h3 id=local-dispatching>Local Dispatching<a class=headerlink href=#local-dispatching title="perma link">#</a></h3><p>Rocket applications are tested by dispatching requests to a local instance of <code>Rocket</code>. The <a href=../../index.html ><code>local</code></a> module contains all of the structures necessary to do so. In particular, it contains a <a href=../../index.html><code>Client</code></a> structure that is used to create <a href=../../index.html><code>LocalRequest</code></a> structures that can be dispatched against a given <a href=../../index.html><code>Rocket</code></a> instance. Usage is straightforward:<ol><li><p>Construct a <code>Rocket</code> instance that represents the application.<table class="code hltable"><tr><td class=linenos><div class=linenodiv><pre>1</pre></div><td class=code><div class="code hl"><pre><span></span><span class=kd>let</span><span class=w> </span><span class=n>rocket</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>rocket</span>::<span class=n>ignite</span><span class=p>();</span><span class=w></span>
</pre></div></table><li><p>Construct a <code>Client</code> using the <code>Rocket</code> instance.<table class="code hltable"><tr><td class=linenos><div class=linenodiv><pre>1</pre></div><td class=code><div class="code hl"><pre><span></span><span class=kd>let</span><span class=w> </span><span class=n>client</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Client</span>::<span class=n>new</span><span class=p>(</span><span class=n>rocket</span><span class=p>).</span><span class=n>expect</span><span class=p>(</span><span class=s>"valid rocket instance"</span><span class=p>);</span><span class=w></span>
</pre></div></table><li><p>Construct requests using the <code>Client</code> instance.<table class="code hltable"><tr><td class=linenos><div class=linenodiv><pre>1</pre></div><td class=code><div class="code hl"><pre><span></span><span class=kd>let</span><span class=w> </span><span class=n>req</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>client</span><span class=p>.</span><span class=n>get</span><span class=p>(</span><span class=s>"/"</span><span class=p>);</span><span class=w></span>
</pre></div></table><li><p>Dispatch the request to retrieve the response.<table class="code hltable"><tr><td class=linenos><div class=linenodiv><pre>1</pre></div><td class=code><div class="code hl"><pre><span></span><span class=kd>let</span><span class=w> </span><span class=n>response</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>req</span><span class=p>.</span><span class=n>dispatch</span><span class=p>();</span><span class=w></span>
</pre></div></table></ol><h3 id=validating-responses>Validating Responses<a class=headerlink href=#validating-responses title="perma link">#</a></h3><p>A <code>dispatch</code> of a <code>LocalRequest</code> returns a <a href=../../index.html><code>LocalResponse</code></a> which can be used transparently as a <a href=../../index.html><code>Response</code></a> value. During testing, the response is usually validated against expected properties. These includes things like the response HTTP status, the inclusion of headers, and expected body data.<p>The <a href=../../index.html><code>Response</code></a> type provides methods to ease this sort of validation. We list a few below:<ul><li><a href=../../index.html#method.status><code>status</code></a>: returns the HTTP status in the response.<li><a href=../../index.html#method.content_type><code>content_type</code></a>: returns the Content-Type header in the response.<li><a href=../../index.html#method.headers><code>headers</code></a>: returns a map of all of the headers in the response.<li><a href=../../index.html#method.body_string><code>body_string</code></a>: returns the body data as a <code>String</code>.<li><a href=../../index.html#method.body_bytes><code>body_bytes</code></a>: returns the body data as a <code>Vec&lt;u8></code>.</ul><p>These methods are typically used in combination with the <code>assert_eq!</code> or <code>assert!</code> macros as follows:<table class="code hltable"><tr><td class=linenos><div class=linenodiv><pre>1
2
3
4
5
6
7
8</pre></div><td class=code><div class="code hl"><pre><span></span><span class=kd>let</span><span class=w> </span><span class=n>rocket</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>rocket</span>::<span class=n>ignite</span><span class=p>();</span><span class=w></span>
<span class=kd>let</span><span class=w> </span><span class=n>client</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Client</span>::<span class=n>new</span><span class=p>(</span><span class=n>rocket</span><span class=p>).</span><span class=n>expect</span><span class=p>(</span><span class=s>"valid rocket instance"</span><span class=p>);</span><span class=w></span>
<span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>response</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>client</span><span class=p>.</span><span class=n>get</span><span class=p>(</span><span class=s>"/"</span><span class=p>).</span><span class=n>dispatch</span><span class=p>();</span><span class=w></span>
<span class=n>assert_eq</span><span class=o>!</span><span class=p>(</span><span class=n>response</span><span class=p>.</span><span class=n>status</span><span class=p>(),</span><span class=w> </span><span class=n>Status</span>::<span class=nb>Ok</span><span class=p>);</span><span class=w></span>
<span class=n>assert_eq</span><span class=o>!</span><span class=p>(</span><span class=n>response</span><span class=p>.</span><span class=n>content_type</span><span class=p>(),</span><span class=w> </span><span class=nb>Some</span><span class=p>(</span><span class=n>ContentType</span>::<span class=n>Plain</span><span class=p>));</span><span class=w></span>
<span class=n>assert</span><span class=o>!</span><span class=p>(</span><span class=n>response</span><span class=p>.</span><span class=n>headers</span><span class=p>().</span><span class=n>get_one</span><span class=p>(</span><span class=s>"X-Special"</span><span class=p>).</span><span class=n>is_some</span><span class=p>());</span><span class=w></span>
<span class=n>assert_eq</span><span class=o>!</span><span class=p>(</span><span class=n>response</span><span class=p>.</span><span class=n>body_string</span><span class=p>(),</span><span class=w> </span><span class=nb>Some</span><span class=p>(</span><span class=s>"Expected Body."</span><span class=p>.</span><span class=n>into</span><span class=p>()));</span><span class=w></span>
</pre></div></table><h3 id=testing-hello-world>Testing "Hello, world!"<a class=headerlink href=#testing-hello-world title="perma link">#</a></h3><p>To solidify an intuition for how Rocket applications are tested, we walk through how to test the "Hello, world!" application below:<table class="code hltable"><tr><td class=linenos><div class=linenodiv><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div><td class=code><div class="code hl"><pre><span></span><span class=cp>#[get(</span><span class=s>"/"</span><span class=cp>)]</span><span class=w></span>
<span class=k>fn</span> <span class=nf>hello</span><span class=p>()</span><span class=w> </span>-> <span class=kp>&</span><span class=nb>'static</span><span class=w> </span><span class=kt>str</span><span class=w> </span><span class=p>{</span><span class=w></span>
<span class=w>    </span><span class=s>"Hello, world!"</span><span class=w></span>
<span class=p>}</span><span class=w></span>
<span class=k>fn</span> <span class=nf>rocket</span><span class=p>()</span><span class=w> </span>-> <span class=nc>Rocket</span><span class=w> </span><span class=p>{</span><span class=w></span>
<span class=w>    </span><span class=n>rocket</span>::<span class=n>ignite</span><span class=p>().</span><span class=n>mount</span><span class=p>(</span><span class=s>"/"</span><span class=p>,</span><span class=w> </span><span class=n>routes</span><span class=o>!</span><span class=p>[</span><span class=n>hello</span><span class=p>])</span><span class=w></span>
<span class=p>}</span><span class=w></span>
<span class=k>fn</span> <span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w></span>
<span class=w>    </span><span class=n>rocket</span><span class=p>().</span><span class=n>launch</span><span class=p>();</span><span class=w></span>
<span class=p>}</span><span class=w></span>
</pre></div></table><p>Notice that we've separated the <em>creation</em> of the <code>Rocket</code> instance from the <em>launch</em> of the instance. As you'll soon see, this makes testing our application easier, less verbose, and less error-prone.<h4 id=setting-up>Setting Up<a class=headerlink href=#setting-up title="perma link">#</a></h4><p>First, we'll create a <code>test</code> module with the proper imports:<table class="code hltable"><tr><td class=linenos><div class=linenodiv><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div><td class=code><div class="code hl"><pre><span></span><span class=cp>#[cfg(test)]</span><span class=w></span>
<span class=k>mod</span> <span class=nn>test</span><span class=w> </span><span class=p>{</span><span class=w></span>
<span class=w>    </span><span class=k>use</span><span class=w> </span><span class=k>super</span>::<span class=n>rocket</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=k>use</span><span class=w> </span><span class=n>rocket</span>::<span class=n>local</span>::<span class=n>Client</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=k>use</span><span class=w> </span><span class=n>rocket</span>::<span class=n>http</span>::<span class=n>Status</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=cp>#[test]</span><span class=w></span>
<span class=w>    </span><span class=k>fn</span> <span class=nf>hello_world</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=p>...</span><span class=w></span>
<span class=w>    </span><span class=p>}</span><span class=w></span>
<span class=p>}</span><span class=w></span>
</pre></div></table><p>You can also move the body of the <code>test</code> module into its own file, say <code>tests.rs</code>, and then import the module into the main file using:<table class="code hltable"><tr><td class=linenos><div class=linenodiv><pre>1</pre></div><td class=code><div class="code hl"><pre><span></span><span class=cp>#[cfg(test)]</span><span class=w> </span><span class=k>mod</span> <span class=nn>tests</span><span class=p>;</span><span class=w></span>
</pre></div></table><h4 id=testing_1>Testing<a class=headerlink href=#testing_1 title="perma link">#</a></h4><p>To test our "Hello, world!" application, we first create a <code>Client</code> for our <code>Rocket</code> instance. It's okay to use methods like <code>expect</code> and <code>unwrap</code> during testing: we <em>want</em> our tests to panic when something goes wrong.<table class="code hltable"><tr><td class=linenos><div class=linenodiv><pre>1</pre></div><td class=code><div class="code hl"><pre><span></span><span class=kd>let</span><span class=w> </span><span class=n>client</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Client</span>::<span class=n>new</span><span class=p>(</span><span class=n>rocket</span><span class=p>()).</span><span class=n>expect</span><span class=p>(</span><span class=s>"valid rocket instance"</span><span class=p>);</span><span class=w></span>
</pre></div></table><p>Then, we create a new <code>GET /</code> request and dispatch it, getting back our application's response:<table class="code hltable"><tr><td class=linenos><div class=linenodiv><pre>1</pre></div><td class=code><div class="code hl"><pre><span></span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>response</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>client</span><span class=p>.</span><span class=n>get</span><span class=p>(</span><span class=s>"/"</span><span class=p>).</span><span class=n>dispatch</span><span class=p>();</span><span class=w></span>
</pre></div></table><p>Finally, we ensure that the response contains the information we expect it to. Here, we want to ensure two things:<ol><li>The status is <code>200 OK</code>.<li>The body is the string "Hello, world!".</ol><p>We do this by checking the <code>Response</code> object directly:<table class="code hltable"><tr><td class=linenos><div class=linenodiv><pre>1
2</pre></div><td class=code><div class="code hl"><pre><span></span><span class=n>assert_eq</span><span class=o>!</span><span class=p>(</span><span class=n>response</span><span class=p>.</span><span class=n>status</span><span class=p>(),</span><span class=w> </span><span class=n>Status</span>::<span class=nb>Ok</span><span class=p>);</span><span class=w></span>
<span class=n>assert_eq</span><span class=o>!</span><span class=p>(</span><span class=n>response</span><span class=p>.</span><span class=n>body_string</span><span class=p>(),</span><span class=w> </span><span class=nb>Some</span><span class=p>(</span><span class=s>"Hello, world!"</span><span class=p>.</span><span class=n>into</span><span class=p>()));</span><span class=w></span>
</pre></div></table><p>That's it! Altogether, this looks like:<table class="code hltable"><tr><td class=linenos><div class=linenodiv><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div><td class=code><div class="code hl"><pre><span></span><span class=cp>#[cfg(test)]</span><span class=w></span>
<span class=k>mod</span> <span class=nn>test</span><span class=w> </span><span class=p>{</span><span class=w></span>
<span class=w>    </span><span class=k>use</span><span class=w> </span><span class=k>super</span>::<span class=n>rocket</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=k>use</span><span class=w> </span><span class=n>rocket</span>::<span class=n>local</span>::<span class=n>Client</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=k>use</span><span class=w> </span><span class=n>rocket</span>::<span class=n>http</span>::<span class=n>Status</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=cp>#[test]</span><span class=w></span>
<span class=w>    </span><span class=k>fn</span> <span class=nf>hello_world</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=kd>let</span><span class=w> </span><span class=n>client</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Client</span>::<span class=n>new</span><span class=p>(</span><span class=n>rocket</span><span class=p>()).</span><span class=n>expect</span><span class=p>(</span><span class=s>"valid rocket instance"</span><span class=p>);</span><span class=w></span>
<span class=w>        </span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>response</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>client</span><span class=p>.</span><span class=n>get</span><span class=p>(</span><span class=s>"/"</span><span class=p>).</span><span class=n>dispatch</span><span class=p>();</span><span class=w></span>
<span class=w>        </span><span class=n>assert_eq</span><span class=o>!</span><span class=p>(</span><span class=n>response</span><span class=p>.</span><span class=n>status</span><span class=p>(),</span><span class=w> </span><span class=n>Status</span>::<span class=nb>Ok</span><span class=p>);</span><span class=w></span>
<span class=w>        </span><span class=n>assert_eq</span><span class=o>!</span><span class=p>(</span><span class=n>response</span><span class=p>.</span><span class=n>body_string</span><span class=p>(),</span><span class=w> </span><span class=nb>Some</span><span class=p>(</span><span class=s>"Hello, world!"</span><span class=p>.</span><span class=n>into</span><span class=p>()));</span><span class=w></span>
<span class=w>    </span><span class=p>}</span><span class=w></span>
<span class=p>}</span><span class=w></span>
</pre></div></table><p>The tests can be run with <code>cargo test</code>. You can find the full source code to <a href=https://github.com/SergioBenitez/Rocket/tree/v0.4/examples/testing>this example on GitHub</a>.<h3 id=codegen-debug>Codegen Debug<a class=headerlink href=#codegen-debug title="perma link">#</a></h3><p>It can be useful to inspect the code that Rocket's code generation is emitting, especially when you get a strange type error. To have Rocket log the code that it is emitting to the console, set the <code>ROCKET_CODEGEN_DEBUG</code> environment variable when compiling:<table class="code hltable"><tr><td class=linenos><div class=linenodiv><pre>1</pre></div><td class=code><div class="code hl"><pre><span></span><span class=n>ROCKET_CODEGEN_DEBUG</span><span class=o>=</span><span class=mi>1</span><span class=w> </span><span class=n>cargo</span><span class=w> </span><span class=n>build</span><span class=w></span>
</pre></div></table><p>During compilation, you should see output like:<table class="code hltable"><tr><td class=linenos><div class=linenodiv><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div><td class=code><div class="code hl"><pre><span></span><span class=n>note</span>: <span class=nc>emitting</span><span class=w> </span><span class=n>Rocket</span><span class=w> </span><span class=n>code</span><span class=w> </span><span class=n>generation</span><span class=w> </span><span class=n>debug</span><span class=w> </span><span class=n>output</span><span class=w></span>
<span class=w> </span><span class=o>-</span>-> <span class=nc>examples</span><span class=o>/</span><span class=n>hello_world</span><span class=o>/</span><span class=n>src</span><span class=o>/</span><span class=n>main</span><span class=p>.</span><span class=n>rs</span>:<span class=mi>7</span>:<span class=mi>1</span><span class=w></span>
<span class=w>  </span><span class=o>|</span><span class=w></span>
<span class=mi>7</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=cp>#[get(</span><span class=s>"/"</span><span class=cp>)]</span><span class=w></span>
<span class=w>  </span><span class=o>|</span><span class=w> </span><span class=o>^^^^^^^^^^^</span><span class=w></span>
<span class=w>  </span><span class=o>|</span><span class=w></span>
<span class=w>  </span><span class=o>=</span><span class=w> </span><span class=n>note</span>:
    <span class=nc>fn</span><span class=w> </span><span class=n>rocket_route_fn_hello</span><span class=o>&lt;</span><span class=na>'_b</span><span class=o>></span><span class=p>(</span><span class=w></span>
<span class=w>        </span><span class=n>__req</span>: <span class=kp>&</span><span class=na>'_b</span><span class=w> </span>::<span class=n>rocket</span>::<span class=n>Request</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=n>__data</span>: ::<span class=n>rocket</span>::<span class=n>Data</span><span class=w></span>
<span class=w>    </span><span class=p>)</span><span class=w> </span>-> ::<span class=n>rocket</span>::<span class=n>handler</span>::<span class=n>Outcome</span><span class=o>&lt;</span><span class=na>'_b</span><span class=o>></span><span class=w> </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=kd>let</span><span class=w> </span><span class=n>responder</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>hello</span><span class=p>();</span><span class=w></span>
<span class=w>        </span>::<span class=n>rocket</span>::<span class=n>handler</span>::<span class=n>Outcome</span>::<span class=n>from</span><span class=p>(</span><span class=n>__req</span><span class=p>,</span><span class=w> </span><span class=n>responder</span><span class=p>)</span><span class=w></span>
<span class=w>    </span><span class=p>}</span><span class=w></span>
</pre></div></table><p>This corresponds to the facade request handler Rocket has generated for the <code>hello</code> route.<hr><div class=grid><div class=col style=float:left><a href=../../index.html>◄ Fairings</a></div><div class="col text-right"><a href=../../v0-4/guide/configuration.html style=margin-left:auto>Configuration ►</a></div></div></article><div id=search-results style=display:none><div class=cancel-search onclick=cancelSearch()></div><span id=search-status></span><hr><br><div id=hits></div></div></section><footer class=grid><div class=container><div class="col mobile-hide"><a href=https://sergio.bz>© 2016-2019 Sergio Benitez</a></div><div class="col centered"><img src=../../v0-4/images/logo-small.svg alt="Small Rocket Logo"></div><div class="col text-right mobile-hide"><a href=#>BACK TO TOP Δ</a></div></div></footer><script src=../../ajax/libs/lunr-js/2-3-3/lunr.min.js charset=utf-8></script><script>function load_index(e,i,s){var a=new XMLHttpRequest;a.open("GET",e,!0),a.onload=function(){if(200<=a.status&&a.status<400){var e=JSON.parse(a.responseText),n=lunr(function(){this.pipeline.reset(),this.pipeline.add(lunr.trimmer),this.field("title",{boost:10}),this.field("body"),this.ref("id");var n=this;e.documents.forEach(function(e){n.add(e)})}),t={};for(var o in e.documents){var r=e.documents[o];t[r.id]=r}i(n,t)}else s("error talking to server")},a.onerror=s,a.send()}function on_search_results(e,n,t){var o,r,i=!1;load_index(e,function(e,n){o=e,r=n,i=!0},function(){console.log("error loading index")});var s=document.getElementById(n);s.addEventListener("keyup",function(){if(i){var e=s.value.trim(),n=o.query(function(n){e.toLowerCase().split(" ").filter(Boolean).forEach(function(e){n.term(e,{wildcard:lunr.Query.wildcard.TRAILING})})}).map(function(e){return r[e.ref]});t(n)}else console.log("index not loaded. aborting search")})}</script><script>var searchBar = document.getElementById('search-input');
    var article = document.getElementsByTagName('article')[0];
    var searchResults = document.getElementById('search-results');
    var cancelButton = document.getElementById("cancel-search");
    var searchStatus = document.getElementById("search-status");
    var hitsDiv = document.getElementById("hits");
    var originalTitle = document.title;
    String.prototype.hashCode = function() {
      var hash = 0, i, chr;
      if (this.length === 0) return hash;
      for (i = 0; i < this.length; i++) {
          chr   = this.charCodeAt(i);
          hash  = ((hash << 5) - hash) + chr;
          hash |= 0; // Convert to 32bit integer
      }
      return hash;
    };
    function toggleResultsIfNecessary() {
      var query = escape(searchBar.value);
      if (query.length > 1) {
        article.style.display = "none";
        searchResults.style.display = "block";
        document.title = `Search for "${query}" - Rocket Programming Guide`;
        return true;
      } else {
        article.style.display = "block";
        searchResults.style.display = "none";
        document.title = originalTitle;
        return false;
      }
    }
    function cancelSearch() {
      searchBar.value = "";
      toggleResultsIfNecessary();
    }
    function escape(string) {
      var doc = new DOMParser().parseFromString(string, 'text/html');
      var stripped = doc.body.textContent || "";
      return stripped.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1").trim();
    }
    function replaceAll(text, query, replacement) {
      var space = new RegExp(lunr.tokenizer.separator, "igm");
      var find = escape(query).replace(space, "|");
      return text.replace(new RegExp(find, 'igm'), replacement);
    }
    function focus(body, query, length, highlight) {
      var space = new RegExp(lunr.tokenizer.separator, "igm");
      var find = escape(query).replace(space, "|");
      var index = body.search(new RegExp(find, 'igm'));
      if (index === -1) {
        return body.substring(0, length) + '..';
      } else {
        var r = body.substring(0, 50).hashCode() % (length / 8);
        var left = Math.max(index - (length / 8) - r, 0);
        var right = Math.min(body.length, left + length);
        var focused = body.substring(left, right).trim();
        var prefix = (left === 0) ? '' : '..';
        var suffix = (right === body.length) ? '' : '..';
        return prefix + focused.replace(new RegExp(find, 'igm'), highlight) + suffix;
      }
    }
    on_search_results("../../v0-4/js/search-index.js", "search-input", function(docs) {
      if (!toggleResultsIfNecessary()) {
        return;
      }
      hitsDiv.innerHTML = "";
      var query = escape(searchBar.value);
      if (docs.length == 0) {
        noResults = `<b>We didn't find any results for <em>"${query}"</em>.</b>`;
        searchStatus.innerHTML = noResults;
        return;
      }
      var top = `<b>Showing ${docs.length} results for <em>"${query}"</em>.</b>`;
      searchStatus.innerHTML = top;
      function highlight(token) {
        return `<em>${token}</em>`;
      }
      for (doc of docs) {
        var docTitle = replaceAll(doc.title, query, highlight);
        var hitHtml =
          `
            <div class="hit">
              <a href="../../guide/${doc.id}"><b>${docTitle}</b></a>
              <br />
              <span>${doc.breadcrumb}</span>
              <p class="hit-content">${focus(doc.body, query, 400, highlight)}</p>
            </div>
        `;
        hitsDiv.insertAdjacentHTML('beforeend', hitHtml);
      }
    })</script><script>function toggleOptions(){if(!(870<=screen.width)){var e=document.querySelector("nav.version-select options");e.style.display="none"===e.style.display?"block":"none"}}</script><script>!function(){var r=null,u=0,a=document.querySelector(".front.clouds"),c=document.querySelector(".back.clouds"),s=20,d=5;window.requestAnimationFrame(function e(n){if(r||(r=n),n-u<50)window.requestAnimationFrame(e);else{var o=n-r,t=s*(o/1e3),i=d*(o/1e3);a.style.backgroundPositionX=-t+"px",c.style.backgroundPositionX=-i+"px",u=n,window.requestAnimationFrame(e)}})}()</script>